<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>–ì–ï–ù–ï–†[–êI]–¢–û–†</title>
  <!-- –§–∞–≤–∏–∫–æ–Ω –≤ –≤–∏–¥–µ —ç–º–æ–¥–∑–∏-–ª–∞–º–ø–æ—á–∫–∏. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤—Å—Ç—Ä–æ–∏—Ç—å –∏–∫–æ–Ω–∫—É –ø—Ä—è–º–æ –≤ HTML, –Ω–µ —Å–æ–∑–¥–∞–≤–∞—è –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ñ–∞–π–ª. -->
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üí°</text></svg>">
  <style>
    /* –ë–∞–∑–æ–≤—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ (mobile-first approach) */
    body { 
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
      padding: 10px; 
      background: #f9f9f9; 
      margin: 0;
    }

    .container {
      max-width: 900px;
      margin: 0 auto;
      padding: 0 10px;
    }

    .block { 
      background: #fff; 
      padding: 20px; 
      border-radius: 8px; 
      margin-bottom: 20px; 
      border: 1px solid #e0e0e0; 
    }
    h1 {
      font-size: 32px;
      color: #222;
      text-align: center;
      margin-bottom: 20px;
    }
    h2 { 
      font-size: 20px; 
      color: #222; 
      margin-bottom: 12px; 
    }
    label { 
      display: block; 
      margin-top: 10px; 
      font-weight: 600; 
      color: #333; 
    }
    input, select, textarea, button { 
      width: 100%; 
      padding: 10px; 
      margin-top: 5px; 
      border-radius: 6px; 
      border: 1px solid #ccc; 
      font-size: 14px; 
      background: #fff; 
      box-sizing: border-box; 
    }
    .btn { 
      background: #222; 
      color: #fff; 
      border: none; 
      cursor: pointer; 
      font-weight: 600; 
      position: relative; 
    }
    .btn:hover { 
      background: #444; 
    }
    .btn:disabled { 
      background: #999; 
      cursor: not-allowed; 
    }
    
    .generate-btn {
      background: #fff;
      color: #222;
      border: 1px solid #222;
      font-weight: 600;
      cursor: pointer;
      position: relative;
      overflow: hidden;
    }

    /* –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä */
    .generate-btn::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 0;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.1);
      transition: width 0.3s ease-in-out;
      z-index: 1;
    }

    .generate-btn.loading {
      cursor: wait;
    }
    
    .generate-btn.loading::after {
      width: 100%;
      animation: progress 2s infinite;
    }

    @keyframes progress {
      0% { width: 0; }
      100% { width: 100%; }
    }

    .generate-btn:hover {
      background: #f0f0f0;
    }

    .generate-btn:disabled {
      background: #f0f0f0;
      border: 1px solid #999;
      color: #999;
      cursor: not-allowed;
    }

    .save-btn {
      background: #f5f5dc; 
      color: #222;
      border: 1px solid #222;
      font-weight: 600;
      cursor: pointer;
      margin-top: 10px; 
    }
    .save-btn:hover {
      background: #e0d9b8;
    }

    .clear-btn { 
      background: #222; 
      color: #fff; 
      border: none;
      margin-top: 15px; 
    }
    .clear-btn:hover { 
      background: #444; 
    }

    .case-buttons { 
      display: flex; 
      gap: 10px; 
      margin-top: 5px; 
      flex-wrap: wrap; 
    }
    .case-buttons button { 
      flex: 1; 
      background: #222; 
      color: #fff; 
      min-width: 100px;
    }
    .case-buttons button.active { 
      background: #28a745; 
    }
    .selected-items { 
      display: flex; 
      gap: 8px; 
      flex-wrap: wrap; 
      margin-top: 10px; 
    }
    .selected-item-btn { 
      background: #eee; 
      color: #333; 
      padding: 6px 12px; 
      border-radius: 6px; 
      cursor: pointer; 
      border: none; 
    }
    .selected-item-btn:hover { 
      background: #ddd; 
    }
    .selected-item-btn.active {
      background: #28a745;
      color: #fff;
    }
    
    textarea { 
      resize: vertical; 
      margin-top: 15px; 
    }
    .status-message {
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      background-color: #333;
      color: white;
      padding: 10px 20px;
      border-radius: 8px;
      z-index: 1000;
      opacity: 0;
      transition: opacity 0.3s ease-in-out;
    }
    
    /* –ú–µ–¥–∏–∞-–∑–∞–ø—Ä–æ—Å—ã –¥–ª—è –ø–ª–∞–Ω—à–µ—Ç–æ–≤ */
    @media (min-width: 600px) {
      body {
        padding: 20px;
      }
      .container {
        padding: 0 20px;
      }
      .block {
        padding: 30px;
      }
    }

    /* –ú–µ–¥–∏–∞-–∑–∞–ø—Ä–æ—Å—ã –¥–ª—è –Ω–∞—Å—Ç–æ–ª—å–Ω—ã—Ö –∫–æ–º–ø—å—é—Ç–µ—Ä–æ–≤ */
    @media (min-width: 900px) {
      .container {
        padding: 0;
      }
      h2 {
        font-size: 24px;
      }
      label {
        font-size: 16px;
      }
      input, select, textarea, button {
        font-size: 16px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>–ì–ï–ù–ï–†[–êI]–¢–û–†</h1>
    <!-- –ë–ª–æ–∫ –≤—ã–±–æ—Ä–∞ –Ω–∏—à–∏ -->
    <div class="block">
      <h2>–í—ã–±–æ—Ä –Ω–∏—à–∏</h2>
      <label for="nicheSelect">–í—ã–±–µ—Ä–∏—Ç–µ –Ω–∏—à—É:</label>
      <select id="nicheSelect" onchange="addSelectedNiche(this)">
        <option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ –Ω–∏—à—É --</option>
      </select>
      <div id="selectedNiches" class="selected-items"></div>
      <label for="customNicheInput">–ò–ª–∏ –≤–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Å–≤–æ–µ–π –Ω–∏—à–∏:</label>
      <input type="text" id="customNicheInput" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–≤–æ—é –Ω–∏—à—É...">
      <button class="btn" onclick="addCustomNicheInput()">–î–æ–±–∞–≤–∏—Ç—å –Ω–∏—à—É</button>
      <label for="customNicheURL">–ò–ª–∏ –≤—Å—Ç–∞–≤—å—Ç–µ —Å–∞–π—Ç/—Å–æ—Ü—Å–µ—Ç—å –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞:</label>
      <input type="text" id="customNicheURL" placeholder="URL –±–∏–∑–Ω–µ—Å–∞ –∏–ª–∏ —Å–æ—Ü—Å–µ—Ç–∏...">
      <button class="btn" onclick="confirmCustomNicheURL()">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å URL/—Å—Å—ã–ª–∫—É</button>
    </div>

    <!-- –ë–ª–æ–∫ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–µ–≥–º–µ–Ω—Ç–æ–≤ -->
    <div class="block">
      <h2>–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–µ–≥–º–µ–Ω—Ç–æ–≤ –¶–ê</h2>
      <label>–ö–ª–∏–∫–Ω–∏—Ç–µ –ø–æ —Å–µ–≥–º–µ–Ω—Ç—É, —á—Ç–æ–±—ã –¥–æ–±–∞–≤–∏—Ç—å –µ–≥–æ:</label>
      <div id="segmentsList" class="selected-items"></div>
      <button id="generateSegmentsBtn" class="generate-btn" onclick="generateSegments()">–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–µ–≥–º–µ–Ω—Ç—ã</button>
      <label for="customSegment" style="margin-top:20px;">–ò–ª–∏ –¥–æ–±–∞–≤—å—Ç–µ —Å–≤–æ–π —Å–µ–≥–º–µ–Ω—Ç:</label>
      <input type="text" id="customSegment" placeholder="–î–æ–±–∞–≤—å—Ç–µ —Å–≤–æ–π —Å–µ–≥–º–µ–Ω—Ç" style="margin-top:10px;"/>
      <button class="btn" onclick="addCustomSegment()">–î–æ–±–∞–≤–∏—Ç—å —Å–µ–≥–º–µ–Ω—Ç</button>
      <div id="selectedSegments" class="selected-items"></div>

      <hr style="margin-top: 20px; border: 0; border-top: 1px solid #ccc;">
      
      <label style="margin-top:20px;">–ü–æ–ª—É—á–∏—Ç—å –ø–æ–¥—Ä–æ–±–Ω—ã–π –æ—Ç—á–µ—Ç –ø–æ —Å–µ–≥–º–µ–Ω—Ç–∞–º:</label>
      <button id="generateDetailedReportBtn" class="generate-btn" onclick="generateDetailedReport()">–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø–æ–¥—Ä–æ–±–Ω—ã–π –æ—Ç—á–µ—Ç</button>
      <textarea id="detailedSegmentsOutput" rows="10" placeholder="–ó–¥–µ—Å—å –±—É–¥–µ—Ç –ø–æ–¥—Ä–æ–±–Ω—ã–π –æ—Ç—á–µ—Ç –ø–æ —Å–µ–≥–º–µ–Ω—Ç–∞–º"></textarea>
      <button class="save-btn" onclick="copyToClipboard('detailedSegmentsOutput')">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
    </div>
    
    <!-- –ù–æ–≤—ã–π –±–ª–æ–∫: –ë–æ–ª–∏ –∏ —Ñ—Ä—É—Å—Ç—Ä–∞—Ü–∏–∏ -->
    <div class="block">
      <h2>–ë–æ–ª–∏ –∏ —Ñ—Ä—É—Å—Ç—Ä–∞—Ü–∏–∏</h2>
      <label>–ö–ª–∏–∫–Ω–∏—Ç–µ –ø–æ –±–æ–ª–∏, —á—Ç–æ–±—ã –¥–æ–±–∞–≤–∏—Ç—å –µ—ë:</label>
      <div id="painsList" class="selected-items"></div>
      <button id="generatePainsBtn" class="generate-btn" onclick="generatePains()">–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –±–æ–ª–∏</button>
      <label for="customPain" style="margin-top:20px;">–ò–ª–∏ –¥–æ–±–∞–≤—å—Ç–µ —Å–≤–æ—é –±–æ–ª—å:</label>
      <input type="text" id="customPain" placeholder="–î–æ–±–∞–≤—å—Ç–µ —Å–≤–æ—é –±–æ–ª—å" style="margin-top:10px;"/>
      <button class="btn" onclick="addCustomPain()">–î–æ–±–∞–≤–∏—Ç—å –±–æ–ª—å</button>
      <div id="selectedPains" class="selected-items"></div>
    </div>

    <!-- –ë–ª–æ–∫ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–µ–π—Å–æ–≤ -->
    <div class="block">
      <h2>–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–µ–π—Å–æ–≤</h2>
      <label>–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –∫–µ–π—Å–∞:</label>
      <div class="case-buttons" id="caseTypes">
        <button class="btn" onclick="toggleCaseType(this, '–û–±—ã—á–Ω—ã–µ')">–û–±—ã—á–Ω—ã–µ</button>
        <button class="btn" onclick="toggleCaseType(this, '–ù–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ')">–ù–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ</button>
        <button class="btn" onclick="toggleCaseType(this, '–ê–±—Å—É—Ä–¥–Ω—ã–µ')">–ê–±—Å—É—Ä–¥–Ω—ã–µ</button>
      </div>
      <button id="generateCasesBtn" class="generate-btn" onclick="generateCases()">–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–µ–π—Å—ã</button>
      <textarea id="caseOutput" rows="6" placeholder="–ó–¥–µ—Å—å –±—É–¥–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏"></textarea>
      <button class="save-btn" onclick="copyToClipboard('caseOutput')">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
    </div>

    <!-- –ë–ª–æ–∫ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –≤–æ—Ä–æ–Ω–æ–∫ AIDA -->
    <div class="block">
      <h2>–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≤–æ—Ä–æ–Ω–æ–∫ (AIDA)</h2>
      <button id="generateFunnelsBtn" class="generate-btn" onclick="generateFunnels()">–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –≤–æ—Ä–æ–Ω–∫—É</button>
      <textarea id="funnelOutput" rows="6" placeholder="–ó–¥–µ—Å—å –±—É–¥–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏"></textarea>
      <button class="save-btn" onclick="copyToClipboard('funnelOutput')">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
    </div>

    <!-- –ù–æ–≤—ã–π –±–ª–æ–∫: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –¥–ª—è —Å–æ—Ü—Å–µ—Ç–µ–π -->
    <div class="block">
        <h2>–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –¥–ª—è —Å–æ—Ü—Å–µ—Ç–µ–π</h2>
        <label>–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –∫–æ–Ω—Ç–µ–Ω—Ç–∞:</label>
        <div class="case-buttons" id="contentTypeButtons">
            <button class="btn" onclick="toggleContentType(this, '–ü–æ—Å—Ç')">–ü–æ—Å—Ç</button>
            <button class="btn" onclick="toggleContentType(this, '–õ–æ–Ω–≥—Ä–∏–¥')">–õ–æ–Ω–≥—Ä–∏–¥</button>
            <button class="btn" onclick="toggleContentType(this, '–°—Ü–µ–Ω–∞—Ä–∏–π —Ä–∏–ª—Å')">–°—Ü–µ–Ω–∞—Ä–∏–π —Ä–∏–ª—Å</button>
        </div>
        <button id="generateSocialMediaBtn" class="generate-btn" onclick="generateSocialMediaContent()">–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∏–¥–µ–∏ –¥–ª—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞</button>
        <textarea id="socialMediaOutput" rows="10" placeholder="–ó–¥–µ—Å—å –±—É–¥–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–¥–µ–π –¥–ª—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞"></textarea>
        <button class="save-btn" onclick="copyToClipboard('socialMediaOutput')">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
    </div>

    <!-- –ë–ª–æ–∫ –ª–∏–¥-–º–∞–≥–Ω–∏—Ç–æ–≤ -->
    <div class="block">
      <h2>–õ–∏–¥-–º–∞–≥–Ω–∏—Ç—ã</h2>
      <label for="leadTitle">–ù–∞–∑–≤–∞–Ω–∏–µ –∫–ª–∏–∫–±–µ–π—Ç–Ω–æ–≥–æ –ª–∏–¥-–º–∞–≥–Ω–∏—Ç–∞:</label>
      <input type="text" id="leadTitle" placeholder="–ü—Ä–∏–¥—É–º–∞–π—Ç–µ –∫–ª–∏–∫–±–µ–π—Ç–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ...">
      <label>–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–æ—Ä–º–∞—Ç –ª–∏–¥-–º–∞–≥–Ω–∏—Ç–∞:</label>
      <div class="case-buttons" id="leadTypes">
        <button class="btn" onclick="toggleLeadType(this, '–≥–∞–π–¥')">–ì–∞–π–¥</button>
        <button class="btn" onclick="toggleLeadType(this, '—á–µ–∫-–ª–∏—Å—Ç')">–ß–µ–∫-–ª–∏—Å—Ç</button>
        <button class="btn" onclick="toggleLeadType(this, '–º–∏–Ω–∏-–∫—É—Ä—Å')">–ú–∏–Ω–∏-–∫—É—Ä—Å</button>
      </div>
      <button id="generateLeadMagnetsBtn" class="generate-btn" onclick="generateLeadMagnets()">–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ª–∏–¥-–º–∞–≥–Ω–∏—Ç</button>
      <textarea id="leadOutput" rows="6" placeholder="–ó–¥–µ—Å—å –±—É–¥–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏"></textarea>
      <button class="save-btn" onclick="copyToClipboard('leadOutput')">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
    </div>
    
    <!-- –ö–Ω–æ–ø–∫–∏ –≤–Ω–∏–∑—É —Å—Ç—Ä–∞–Ω–∏—Ü—ã -->
    <button class="save-btn" onclick="copyAllBlocks()">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤—Å—ë</button>
    <button class="clear-btn" onclick="clearAllData()">–û—á–∏—Å—Ç–∏—Ç—å –≤—Å—ë</button>
    <div id="status-message" class="status-message"></div>
  </div>

  <script>
    const niches = [
      {category: '–•–æ—Ä–µ–∫–∞', businesses: ["–†–µ—Å—Ç–æ—Ä–∞–Ω—ã","–ö–∞—Ñ–µ","–ë–∞—Ä—ã","–ö–æ—Ñ–µ–π–Ω–∏","–ü–∏—Ü—Ü–µ—Ä–∏–∏","–§–∞—Å—Ç—Ñ—É–¥","–°—Ç–æ–ª–æ–≤—ã–µ","–§—É–¥—Ç—Ä–∞–∫–∏","–í–µ–≥–∞–Ω—Å–∫–∏–µ/–≤–µ–≥–µ—Ç–∞—Ä–∏–∞–Ω—Å–∫–∏–µ –∫–∞—Ñ–µ","–î–æ—Å—Ç–∞–≤–∫–∞ –µ–¥—ã","–ö–æ–Ω–¥–∏—Ç–µ—Ä—Å–∫–∏–µ","–ö–µ–π—Ç–µ—Ä–∏–Ω–≥","–°—É—à–∏-–±–∞—Ä—ã","–ë—Ä–∞–Ω—á–∏","Fine dining","–ö—É–ª–∏–Ω–∞—Ä–Ω—ã–µ –º–∞—Å—Ç–µ—Ä-–∫–ª–∞—Å—Å—ã"]},
      {category: '–ö—Ä–∞—Å–æ—Ç–∞ –∏ –∑–¥–æ—Ä–æ–≤—å–µ', businesses: ["–ü–∞—Ä–∏–∫–º–∞—Ö–µ—Ä—Å–∫–∏–µ","–ë–∞—Ä–±–µ—Ä—à–æ–ø—ã","–°–∞–ª–æ–Ω—ã –º–∞–Ω–∏–∫—é—Ä–∞","–°–∞–ª–æ–Ω—ã –∫—Ä–∞—Å–æ—Ç—ã","–°–ü–ê-—Å–∞–ª–æ–Ω—ã","–ö–æ—Å–º–µ—Ç–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ –∫–ª–∏–Ω–∏–∫–∏","–§–∏—Ç–Ω–µ—Å-–∫–ª—É–±—ã","–ô–æ–≥–∞-—Å—Ç—É–¥–∏–∏","–ú–∞—Å—Å–∞–∂–Ω—ã–µ —Å–∞–ª–æ–Ω—ã","–î–∏–µ—Ç–æ–ª–æ–≥–∏","–ü—Å–∏—Ö–æ—Ç–µ—Ä–∞–ø–µ–≤—Ç—ã","–°—Ç–æ–º–∞—Ç–æ–ª–æ–≥–∏—è","–ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ –∫–ª–∏–Ω–∏–∫–∏","–û–Ω–ª–∞–π–Ω-—Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏","Wellness-retreats","–ù–∞—Ç—É—Ä–∞–ª—å–Ω—ã–µ –ë–ê–î—ã"]},
      {category: '–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ', businesses: ["–®–∫–æ–ª—ã","–î–µ—Ç—Å–∫–∏–µ —Å–∞–¥—ã","–û–Ω–ª–∞–π–Ω-–∫—É—Ä—Å—ã","–Ø–∑—ã–∫–æ–≤—ã–µ —à–∫–æ–ª—ã","–£–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç—ã","–£—á–µ–±–Ω—ã–µ —Ü–µ–Ω—Ç—Ä—ã","–¢—Ä–µ–Ω–∏–Ω–≥–æ–≤—ã–µ –∫–æ–º–ø–∞–Ω–∏–∏","–†–µ–ø–µ—Ç–∏—Ç–æ—Ä—ã","IT-–∞–∫–∞–¥–µ–º–∏–∏","STEM-–∫—É—Ä—Å—ã","–ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ"]},
      {category: '–ù–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å', businesses: ["–ê–≥–µ–Ω—Ç—Å—Ç–≤–∞ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏","–ó–∞—Å—Ç—Ä–æ–π—â–∏–∫–∏","–°–µ—Ä–≤–∏—Å—ã –∞—Ä–µ–Ω–¥—ã","–ö–æ–≤–æ—Ä–∫–∏–Ω–≥–∏","–ê–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç—ã","–û—Ç–µ–ª–∏"]},
      {category: '–†–∏—Ç–µ–π–ª', businesses: ["–°—É–ø–µ—Ä–º–∞—Ä–∫–µ—Ç—ã","–ú–∞–≥–∞–∑–∏–Ω—ã –æ–¥–µ–∂–¥—ã","–ú–∞–≥–∞–∑–∏–Ω—ã –æ–±—É–≤–∏","–≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞","–û–Ω–ª–∞–π–Ω-–º–∞–≥–∞–∑–∏–Ω—ã","–ë—É—Ç–∏–∫–∏","–°–ø–æ—Ä—Ç–∏–≤–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã","–¢–æ–≤–∞—Ä—ã –¥–ª—è –¥–æ–º–∞","–ö–∞–Ω—Ü–µ–ª—è—Ä–∏—è","–ö–Ω–∏–≥–∏"]},
      {category: '–ê–≤—Ç–æ', businesses: ["–ê–≤—Ç–æ—Å–∞–ª–æ–Ω—ã","–°–¢–û","–ê–≤—Ç–æ–º–æ–π–∫–∏","–ü—Ä–æ–∫–∞—Ç –∞–≤—Ç–æ","–®–∫–æ–ª—ã –≤–æ–∂–¥–µ–Ω–∏—è","–ö–∞—Ä—à–µ—Ä–∏–Ω–≥","–®–∏–Ω—ã –∏ –¥–∏—Å–∫–∏","–≠–ª–µ–∫—Ç—Ä–æ—Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç"]},
      {category: '–†–∞–∑–≤–ª–µ—á–µ–Ω–∏—è –∏ –º–µ–¥–∏–∞', businesses: ["–ö–∏–Ω–æ—Ç–µ–∞—Ç—Ä—ã","–¢–µ–∞—Ç—Ä—ã","–ö–æ–Ω—Ü–µ—Ä—Ç–Ω—ã–µ –∑–∞–ª—ã","–ò–≥—Ä–æ–≤—ã–µ –∫–ª—É–±—ã","–ö–≤–µ—Å—Ç—ã","–î–µ—Ç—Å–∫–∏–µ —Ä–∞–∑–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω—ã–µ —Ü–µ–Ω—Ç—Ä—ã","–ë–ª–æ–≥–µ—Ä—ã","–°—Ç—Ä–∏–º–µ—Ä—ã","VR-—Ä–∞–∑–≤–ª–µ—á–µ–Ω–∏—è","–ü–æ–¥–∫–∞—Å—Ç—ã","–ú—É–∑—ã–∫–∞–ª—å–Ω—ã–µ —Å—Ç—É–¥–∏–∏"]},
      {category: 'IT –∏ digital', businesses: ["–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ —Å–∞–π—Ç–æ–≤","–ü—Ä–æ–¥–≤–∏–∂–µ–Ω–∏–µ –≤ —Å–æ—Ü—Å–µ—Ç—è—Ö","–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π","SaaS-—Å–µ—Ä–≤–∏—Å—ã","–ú–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤—ã–µ –∞–≥–µ–Ω—Ç—Å—Ç–≤–∞","SEO-—Å—Ç—É–¥–∏–∏","UX/UI-–¥–∏–∑–∞–π–Ω","CRM-—Å–∏—Å—Ç–µ–º—ã","Email-–º–∞—Ä–∫–µ—Ç–∏–Ω–≥","–ö–æ–Ω—Ç–µ–Ω—Ç-–∞–≥–µ–Ω—Ç—Å—Ç–≤–∞"]},
      {category: '–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –∏ –≥–∞–¥–∂–µ—Ç—ã', businesses: ["–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ IoT —É—Å—Ç—Ä–æ–π—Å—Ç–≤","VR/AR –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è","–≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞","–ì–∞–¥–∂–µ—Ç—ã –¥–ª—è –¥–æ–º–∞","–°–º–∞—Ä—Ç-–≥–∞–¥–∂–µ—Ç—ã","Wearables"]},
      {category: '–î–æ–º –∏ –∏–Ω—Ç–µ—Ä—å–µ—Ä', businesses: ["–ú–µ–±–µ–ª—å","–î–µ–∫–æ—Ä","–¢–µ–∫—Å—Ç–∏–ª—å","–û—Å–≤–µ—â–µ–Ω–∏–µ","–†–µ–º–æ–Ω—Ç –∏ –æ—Ç–¥–µ–ª–∫–∞","–°–∞–Ω—Ç–µ—Ö–Ω–∏–∫–∞","–°–∞–¥ –∏ –æ–≥–æ—Ä–æ–¥","–õ–∞–Ω–¥—à–∞—Ñ—Ç–Ω—ã–π –¥–∏–∑–∞–π–Ω","–ö–ª–∏–Ω–∏–Ω–≥","–£–º–Ω—ã–π –¥–æ–º"]},
      {category: '–§–∏–Ω–∞–Ω—Å—ã –∏ —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ', businesses: ["–ë–∞–Ω–∫–∏","–°—Ç—Ä–∞—Ö–æ–≤—ã–µ –∫–æ–º–ø–∞–Ω–∏–∏","–ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–æ–Ω—Å—ã","–§–∏–Ω–∞–Ω—Å–æ–≤—ã–π –∫–æ–Ω—Å–∞–ª—Ç–∏–Ω–≥","FinTech"]},
      {category: '–ñ–∏–≤–æ—Ç–Ω—ã–µ –∏ —ç–∫–æ–ª–æ–≥–∏—è', businesses: ["–í–µ—Ç–µ—Ä–∏–Ω–∞—Ä–Ω—ã–µ –∫–ª–∏–Ω–∏–∫–∏","–¢–æ–≤–∞—Ä—ã –¥–ª—è –∂–∏–≤–æ—Ç–Ω—ã—Ö","–£—Å–ª—É–≥–∏ –¥–ª—è –ø–∏—Ç–æ–º—Ü–µ–≤","–≠–∫–æ-–ø—Ä–æ–¥—É–∫—Ç—ã","–≠–∫–æ-—Å—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–æ","–û–∑–µ–ª–µ–Ω–µ–Ω–∏–µ"]}
    ];

    const selectedNichesArr = [];
    const selectedSegmentsArr = [];
    const selectedPainsArr = [];
    let selectedCaseType = '';
    let selectedLeadType = '';
    let selectedContentType = '';
    
    // API-–∫–ª—é—á —Ç–µ–ø–µ—Ä—å —Å–∫—Ä—ã—Ç –≤ –ø—Ä–æ–∫—Å–∏-—Å–µ—Ä–≤–µ—Ä–µ Vercel.
    const PROXY_URL = '/api/vercel-proxy';

    function showStatusMessage(message) {
      const statusElement = document.getElementById('status-message');
      if (!statusElement) return;
      statusElement.textContent = message;
      statusElement.style.opacity = '1';
      setTimeout(() => {
        statusElement.style.opacity = '0';
      }, 3000);
    }
    
    function toggleLoader(buttonId, show) {
      const button = document.getElementById(buttonId);
      if (show) {
        button.disabled = true;
        button.classList.add('loading');
      } else {
        button.disabled = false;
        button.classList.remove('loading');
      }
    }
    
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–µ–∫—Å—Ç–∞ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞
    function copyToClipboard(elementId) {
      const textarea = document.getElementById(elementId);
      if (!textarea || !textarea.value) {
        showStatusMessage('–ù–µ—Ç —Ç–µ–∫—Å—Ç–∞ –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è.');
        return;
      }
      textarea.select();
      document.execCommand('copy');
      showStatusMessage('–°–æ–¥–µ—Ä–∂–∏–º–æ–µ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!');
    }

    // –ù–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –≤—Å–µ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
    function copyAllBlocks() {
        const outputs = [
            { id: 'detailedSegmentsOutput', title: '–ü–æ–¥—Ä–æ–±–Ω—ã–π –æ—Ç—á–µ—Ç –ø–æ —Å–µ–≥–º–µ–Ω—Ç–∞–º' },
            { id: 'caseOutput', title: '–ö–µ–π—Å—ã' },
            { id: 'funnelOutput', title: '–í–æ—Ä–æ–Ω–∫–∏ AIDA' },
            { id: 'socialMediaOutput', title: '–ò–¥–µ–∏ –¥–ª—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞' },
            { id: 'leadOutput', title: '–õ–∏–¥-–º–∞–≥–Ω–∏—Ç—ã' }
        ];

        let combinedText = '';

        outputs.forEach(output => {
            const textarea = document.getElementById(output.id);
            if (textarea && textarea.value.trim() !== '') {
                combinedText += `\n--- ${output.title} ---\n\n`;
                combinedText += textarea.value + '\n';
            }
        });

        if (combinedText.trim() === '') {
            showStatusMessage('–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è.');
            return;
        }

        const tempTextarea = document.createElement('textarea');
        tempTextarea.value = combinedText;
        document.body.appendChild(tempTextarea);
        tempTextarea.select();
        document.execCommand('copy');
        document.body.removeChild(tempTextarea);

        showStatusMessage('–í—Å–µ –¥–∞–Ω–Ω—ã–µ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω—ã!');
    }

    async function generateContentWithGemini(userPrompt, systemPrompt) {
      const payload = {
        userPrompt: userPrompt,
        systemPrompt: systemPrompt
      };

      try {
        const response = await fetch(PROXY_URL, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(payload)
        });

        if (!response.ok) {
          const errorData = await response.json();
          throw new Error(errorData.error || '–û—à–∏–±–∫–∞ –ø—Ä–æ–∫—Å–∏-—Å–µ—Ä–≤–µ—Ä–∞.');
        }

        const result = await response.json();
        return result.text;

      } catch (error) {
        console.error("API call failed:", error);
        showStatusMessage('–û—à–∏–±–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.');
        throw error;
      }
    }
    
    function populateNiches() {
      const select = document.getElementById('nicheSelect');
      niches.forEach(n => {
        const optGroup = document.createElement('optgroup');
        optGroup.label = n.category;
        n.businesses.forEach(b => {
          const option = document.createElement('option');
          option.value = `${n.category} - ${b}`;
          option.textContent = b;
          optGroup.appendChild(option);
        });
        select.appendChild(optGroup);
      });
    }

    function toggleCaseType(btn, type) {
      document.querySelectorAll('#caseTypes button').forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
      selectedCaseType = type;
    }
    
    function toggleLeadType(btn, type) {
      document.querySelectorAll('#leadTypes button').forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
      selectedLeadType = type;
    }

    function toggleContentType(btn, type) {
        document.querySelectorAll('#contentTypeButtons button').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        selectedContentType = type;
    }


    function clearAllData() {
      // –û—á–∏—Å—Ç–∫–∞ –ø–æ–ª–µ–π –≤–≤–æ–¥–∞ –∏ textarea
      document.querySelectorAll('input[type="text"], textarea').forEach(t => t.value = '');
      
      // –û—á–∏—Å—Ç–∫–∞ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
      document.getElementById('selectedNiches').innerHTML = '';
      document.getElementById('selectedSegments').innerHTML = '';
      document.getElementById('selectedPains').innerHTML = '';

      // –û—á–∏—Å—Ç–∫–∞ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å–ø–∏—Å–∫–æ–≤
      document.getElementById('segmentsList').innerHTML = '';
      document.getElementById('painsList').innerHTML = '';

      // –°–±—Ä–æ—Å –∞–∫—Ç–∏–≤–Ω—ã—Ö –∫–Ω–æ–ø–æ–∫
      document.querySelectorAll('.case-buttons button').forEach(b => b.classList.remove('active'));
      
      // –°–±—Ä–æ—Å –º–∞—Å—Å–∏–≤–æ–≤
      selectedNichesArr.length = 0;
      selectedSegmentsArr.length = 0;
      selectedPainsArr.length = 0;
      selectedCaseType = '';
      selectedLeadType = '';
      selectedContentType = '';
      
      showStatusMessage('–í—Å–µ –¥–∞–Ω–Ω—ã–µ –æ—á–∏—â–µ–Ω—ã!');
    }

    const segmentsList = document.getElementById('segmentsList');
    const selectedSegments = document.getElementById('selectedSegments');
    const painsList = document.getElementById('painsList');
    const selectedPains = document.getElementById('selectedPains');

    async function generateSegments() {
      if (selectedNichesArr.length === 0) {
        showStatusMessage('–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ –Ω–∏—à—É!');
        return;
      }
      toggleLoader('generateSegmentsBtn', true);
      const prompt = `–°–≥–µ–Ω–µ—Ä–∏—Ä—É–π 7-10 –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —à–∏—Ä–æ–∫–∏—Ö –∏ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–Ω—ã—Ö —Å–µ–≥–º–µ–Ω—Ç–æ–≤ —Ü–µ–ª–µ–≤–æ–π –∞—É–¥–∏—Ç–æ—Ä–∏–∏ –¥–ª—è —Å–ª–µ–¥—É—é—â–∏—Ö –Ω–∏—à: ${selectedNichesArr.join(', ')}. –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π –¥–µ–º–æ–≥—Ä–∞—Ñ–∏—é, –∏–Ω—Ç–µ—Ä–µ—Å—ã, –ø–æ–≤–µ–¥–µ–Ω–∏–µ –∏ –ø—Å–∏—Ö–æ–≥—Ä–∞—Ñ–∏–∫—É. –í–∫–ª—é—á–∏ –Ω–µ —Ç–æ–ª—å–∫–æ –æ—á–µ–≤–∏–¥–Ω—ã–µ, –Ω–æ –∏ –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ, "—ç–∫–∑–æ—Ç–∏—á–µ—Å–∫–∏–µ" —Å–µ–≥–º–µ–Ω—Ç—ã. –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–µ–≥–º–µ–Ω—Ç–∞ –∏—Å–ø–æ–ª—å–∑—É–π —Ñ–æ—Ä–º–∞—Ç "–ù–∞–∑–≤–∞–Ω–∏–µ —Å–µ–≥–º–µ–Ω—Ç–∞ - –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ".`;
      const systemPrompt = '–¢—ã - –º–∞—Ä–∫–µ—Ç–æ–ª–æ–≥-–∞–Ω–∞–ª–∏—Ç–∏–∫, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–∑–¥–∞–µ—Ç –¥–µ—Ç–∞–ª—å–Ω—ã–µ –ø–æ—Ä—Ç—Ä–µ—Ç—ã –¶–ê.';
      
      try {
        const resultText = await generateContentWithGemini(prompt, systemPrompt);
        const segments = resultText.split('\n').filter(s => s.trim() !== '');
        segmentsList.innerHTML = '';
        segments.forEach(seg => {
          const btn = document.createElement('button');
          btn.textContent = seg;
          btn.className = 'selected-item-btn';
          btn.onclick = () => addSegmentToSelected(seg);
          segmentsList.appendChild(btn);
        });
        showStatusMessage('–°–µ–≥–º–µ–Ω—Ç—ã —É—Å–ø–µ—à–Ω–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω—ã!');
      } catch (error) {
        console.error("Failed to generate segments:", error);
      } finally {
        toggleLoader('generateSegmentsBtn', false);
      }
    }

    async function generateDetailedReport() {
      if (selectedNichesArr.length === 0) {
        showStatusMessage('–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ –Ω–∏—à—É!');
        return;
      }
      toggleLoader('generateDetailedReportBtn', true);
      const prompt = `–°–≥–µ–Ω–µ—Ä–∏—Ä—É–π –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –ø–æ–¥—Ä–æ–±–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Ü–µ–ª–µ–≤–æ–π –∞—É–¥–∏—Ç–æ—Ä–∏–∏ –¥–ª—è —Å–ª–µ–¥—É—é—â–∏—Ö –Ω–∏—à: ${selectedNichesArr.join(', ')}. –í—ã–¥–µ–ª–∏ –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ —Å–µ–≥–º–µ–Ω—Ç—ã, –¥–∞–π –∫–∞–∂–¥–æ–º—É –¥–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ (–¥–µ–º–æ–≥—Ä–∞—Ñ–∏—è, –±–æ–ª–∏, –∏–Ω—Ç–µ—Ä–µ—Å—ã, –ø–æ–≤–µ–¥–µ–Ω–∏–µ) –∏ —É–∫–∞–∂–∏ –ø—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ–Ω—Ç –æ—Ç –æ–±—â–µ–π –∞—É–¥–∏—Ç–æ—Ä–∏–∏. –°—Ñ–æ—Ä–º—É–ª–∏—Ä—É–π –æ—Ç–≤–µ—Ç –≤ –≤–∏–¥–µ –ø–æ–¥—Ä–æ–±–Ω–æ–≥–æ –æ—Ç—á–µ—Ç–∞.`;
      const systemPrompt = '–¢—ã - –º–∞—Ä–∫–µ—Ç–æ–ª–æ–≥-–∞–Ω–∞–ª–∏—Ç–∏–∫, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–∑–¥–∞–µ—Ç –¥–µ—Ç–∞–ª—å–Ω—ã–µ –ø–æ—Ä—Ç—Ä–µ—Ç—ã –¶–ê.';
      try {
        const resultText = await generateContentWithGemini(prompt, systemPrompt);
        document.getElementById('detailedSegmentsOutput').value = resultText;
        showStatusMessage('–î–µ—Ç–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç –ø–æ —Å–µ–≥–º–µ–Ω—Ç–∞–º —É—Å–ø–µ—à–Ω–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω!');
      } catch (error) {
        document.getElementById('detailedSegmentsOutput').value = '–û—à–∏–±–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.';
      } finally {
        toggleLoader('generateDetailedReportBtn', false);
      }
    }

    async function generatePains() {
      if (selectedNichesArr.length === 0) {
        showStatusMessage('–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ –Ω–∏—à—É!');
        return;
      }
      toggleLoader('generatePainsBtn', true);
      const prompt = `–ü—Ä–æ–≤–µ–¥–∏ –≥–ª—É–±–æ–∫–∏–π –∞–Ω–∞–ª–∏–∑ –∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–π 7-10 –±–æ–ª–µ–π –∏ —Ñ—Ä—É—Å—Ç—Ä–∞—Ü–∏–π –¥–ª—è —Ü–µ–ª–µ–≤–æ–π –∞—É–¥–∏—Ç–æ—Ä–∏–∏ –≤ —Å–ª–µ–¥—É—é—â–∏—Ö –Ω–∏—à–∞—Ö: ${selectedNichesArr.join(', ')}. –î–ª—è –∫–∞–∂–¥–æ–π –±–æ–ª–∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤—å –¥–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ, –æ–±—ä—è—Å–Ω–∏ –µ–µ –ø—Ä–∏—á–∏–Ω—ã, –∫–∞–∫ –æ–Ω–∞ –ø—Ä–æ—è–≤–ª—è–µ—Ç—Å—è –≤ –∂–∏–∑–Ω–∏ –∫–ª–∏–µ–Ω—Ç–∞ –∏ –∫–∞–∫–∏–µ "—Ç—Ä–∏–≥–≥–µ—Ä—ã" –µ–µ –≤—ã–∑—ã–≤–∞—é—Ç. –ü—Ä–µ–¥—Å—Ç–∞–≤—å —ç—Ç–æ –∫–∞–∫ —á–∞—Å—Ç—å –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–≥–æ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤–æ–≥–æ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è.`;
      const systemPrompt = '–¢—ã - –º–∞—Ä–∫–µ—Ç–æ–ª–æ–≥-–∞–Ω–∞–ª–∏—Ç–∏–∫, –∫–æ—Ç–æ—Ä—ã–π –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –±–æ–ª–∏ –∏ –ø—Ä–æ–±–ª–µ–º—ã —Ü–µ–ª–µ–≤–æ–π –∞—É–¥–∏—Ç–æ—Ä–∏–∏.';
      try {
        const resultText = await generateContentWithGemini(prompt, systemPrompt);
        const pains = resultText.split('\n').filter(s => s.trim() !== '');
        painsList.innerHTML = '';
        pains.forEach(pain => {
          const btn = document.createElement('button');
          btn.textContent = pain;
          btn.className = 'selected-item-btn';
          btn.onclick = () => addPainToSelected(pain);
          painsList.appendChild(btn);
        });
        showStatusMessage('–ë–æ–ª–∏ —É—Å–ø–µ—à–Ω–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω—ã!');
      } catch (error) {
        console.error("Failed to generate pains:", error);
      } finally {
        toggleLoader('generatePainsBtn', false);
      }
    }

    function addCustomSegment() {
      const input = document.getElementById('customSegment');
      const val = input.value.trim();
      if (!val) return;
      addSegmentToSelected(val);
      input.value = '';
    }

    function addCustomPain() {
      const input = document.getElementById('customPain');
      const val = input.value.trim();
      if (!val) return;
      addPainToSelected(val);
      input.value = '';
    }

    function addSegmentToSelected(seg) {
      if (selectedSegmentsArr.includes(seg)) {
        showStatusMessage('–≠—Ç–æ—Ç —Å–µ–≥–º–µ–Ω—Ç —É–∂–µ –≤—ã–±—Ä–∞–Ω!');
        return;
      }
      const selBtn = document.createElement('button');
      selBtn.textContent = seg;
      selBtn.className = 'selected-item-btn';
      selBtn.onclick = () => {
          selectedSegments.removeChild(selBtn);
          const index = selectedSegmentsArr.indexOf(seg);
          if (index > -1) selectedSegmentsArr.splice(index, 1);
      };
      selectedSegments.appendChild(selBtn);
      selectedSegmentsArr.push(seg);
      showStatusMessage(`"${seg}" –¥–æ–±–∞–≤–ª–µ–Ω –≤ –≤—ã–±—Ä–∞–Ω–Ω—ã–µ —Å–µ–≥–º–µ–Ω—Ç—ã.`);
    }

    function addPainToSelected(pain) {
      if (selectedPainsArr.includes(pain)) {
        showStatusMessage('–≠—Ç–∞ –±–æ–ª—å —É–∂–µ –≤—ã–±—Ä–∞–Ω–∞!');
        return;
      }
      const selBtn = document.createElement('button');
      selBtn.textContent = pain;
      selBtn.className = 'selected-item-btn';
      selBtn.onclick = () => {
          selectedPains.removeChild(selBtn);
          const index = selectedPainsArr.indexOf(pain);
          if (index > -1) selectedPainsArr.splice(index, 1);
      };
      selectedPains.appendChild(selBtn);
      selectedPainsArr.push(pain);
      showStatusMessage(`"${pain}" –¥–æ–±–∞–≤–ª–µ–Ω –≤ –≤—ã–±—Ä–∞–Ω–Ω—ã–µ –±–æ–ª–∏.`);
    }

    const selectedNichesDom = document.getElementById('selectedNiches');
    function addSelectedNiche(sel) {
      const val = sel.value;
      if (!val) return;
      if (selectedNichesArr.includes(val)) {
        sel.value = '';
        return;
      }
      const btn = document.createElement('button');
      btn.textContent = val;
      btn.className = 'selected-item-btn';
      btn.onclick = () => {
        selectedNichesDom.removeChild(btn);
        const index = selectedNichesArr.indexOf(val);
        if (index > -1) selectedNichesArr.splice(index, 1);
      };
      selectedNichesDom.appendChild(btn);
      selectedNichesArr.push(val);
      sel.value = '';
    }

    function addCustomNicheInput() {
      const input = document.getElementById('customNicheInput');
      const val = input.value.trim();
      if (!val) return;
      if (selectedNichesArr.includes(val)) {
        input.value = '';
        return;
      }
      const btn = document.createElement('button');
      btn.textContent = val;
      btn.className = 'selected-item-btn';
      btn.onclick = () => {
        selectedNichesDom.removeChild(btn);
        const index = selectedNichesArr.indexOf(val);
        if (index > -1) selectedNichesArr.splice(index, 1);
      };
      selectedNichesDom.appendChild(btn);
      input.value = '';
    }

    function confirmCustomNicheURL() {
      const url = document.getElementById('customNicheURL').value.trim();
      if (!url) return;
      if (selectedNichesArr.includes(url)) {
        document.getElementById('customNicheURL').value = '';
        return;
      }
      const btn = document.createElement('button');
      btn.textContent = url;
      btn.className = 'selected-item-btn';
      btn.onclick = () => {
        selectedNichesDom.removeChild(btn);
        const index = selectedNichesArr.indexOf(url);
        if (index > -1) selectedNichesArr.splice(index, 1);
      };
      selectedNichesDom.appendChild(btn);
      document.getElementById('customNicheURL').value = '';
    }
    
    async function generateLeadMagnets() {
      const leadTitle = document.getElementById('leadTitle').value.trim();
      if (!leadTitle || !selectedLeadType || selectedNichesArr.length === 0 || selectedSegmentsArr.length === 0 || selectedPainsArr.length === 0) {
        showStatusMessage('–í—ã–±–µ—Ä–∏—Ç–µ –Ω–∏—à—É, —Å–µ–≥–º–µ–Ω—Ç, –±–æ–ª—å, –≤–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∏ –≤—ã–±–µ—Ä–∏—Ç–µ —Ñ–æ—Ä–º–∞—Ç!');
        return;
      }
      toggleLoader('generateLeadMagnetsBtn', true);
      const prompt = `–°–≥–µ–Ω–µ—Ä–∏—Ä—É–π 3-5 –∏–¥–µ–π –ª–∏–¥-–º–∞–≥–Ω–∏—Ç–æ–≤ —Ñ–æ—Ä–º–∞—Ç–∞ "${selectedLeadType}" —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º "${leadTitle}". –≠—Ç–∏ –ª–∏–¥-–º–∞–≥–Ω–∏—Ç—ã –¥–æ–ª–∂–Ω—ã —Ä–µ—à–∞—Ç—å –±–æ–ª–∏ (${selectedPainsArr.join(', ')}) –∏ –±—ã—Ç—å –Ω–∞—Ü–µ–ª–µ–Ω—ã –Ω–∞ —Å–µ–≥–º–µ–Ω—Ç—ã (${selectedSegmentsArr.join(', ')}) –≤ –Ω–∏—à–∞—Ö: ${selectedNichesArr.join(', ')}. –û–ø–∏—à–∏ –∫–∞–∂–¥—É—é –∏–¥–µ—é —Å –¥–µ—Ç–∞–ª—è–º–∏ –∏ –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä—É–µ–º—ã–º–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏.`;
      const systemPrompt = '–¢—ã - —ç–∫—Å–ø–µ—Ä—Ç –ø–æ –ª–∏–¥–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏–¥—É–º—ã–≤–∞–µ—Ç —Ü–µ–Ω–Ω—ã–µ –∏ –ø—Ä–∏–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –¥–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤.';
      try {
        const resultText = await generateContentWithGemini(prompt, systemPrompt);
        document.getElementById('leadOutput').value = resultText;
        showStatusMessage('–õ–∏–¥-–º–∞–≥–Ω–∏—Ç—ã —É—Å–ø–µ—à–Ω–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω—ã!');
      } catch (error) {
        document.getElementById('leadOutput').value = '–û—à–∏–±–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.';
      } finally {
        toggleLoader('generateLeadMagnetsBtn', false);
      }
    }

    async function generateCases() {
      if (selectedNichesArr.length === 0 || selectedSegmentsArr.length === 0 || selectedPainsArr.length === 0 || !selectedCaseType) {
        showStatusMessage('–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ –Ω–∏—à—É, —Å–µ–≥–º–µ–Ω—Ç, –±–æ–ª—å –∏ —Ç–∏–ø –∫–µ–π—Å–∞!');
        return;
      }
      toggleLoader('generateCasesBtn', true);
      const prompt = `–°–≥–µ–Ω–µ—Ä–∏—Ä—É–π 3-5 –∏–¥–µ–π ${selectedCaseType.toLowerCase()} –∫–µ–π—Å–æ–≤ –¥–ª—è –Ω–∏—à: ${selectedNichesArr.join(', ')}. –ö–µ–π—Å—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –Ω–∞—Ü–µ–ª–µ–Ω—ã –Ω–∞ —Å–µ–≥–º–µ–Ω—Ç—ã: ${selectedSegmentsArr.join(', ')} –∏ —Ä–µ—à–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –±–æ–ª–∏ –∏ —Ñ—Ä—É—Å—Ç—Ä–∞—Ü–∏–∏: ${selectedPainsArr.join(', ')}. –û–ø–∏—à–∏ –∫–∞–∂–¥—ã–π –∫–µ–π—Å –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –∞–±–∑–∞—Ü–µ, –≤–∫–ª—é—á–∞—è –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä—É–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, "—É–≤–µ–ª–∏—á–µ–Ω–∏–µ –ø—Ä–æ–¥–∞–∂ –Ω–∞ X%").`;
      const systemPrompt = '–¢—ã - –∫—Ä–µ–∞—Ç–∏–≤–Ω—ã–π –¥–∏—Ä–µ–∫—Ç–æ—Ä, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏–¥—É–º—ã–≤–∞–µ—Ç —è—Ä–∫–∏–µ –∏ –∑–∞–ø–æ–º–∏–Ω–∞—é—â–∏–µ—Å—è –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤—ã–µ –∫–µ–π—Å—ã.';
      try {
        const resultText = await generateContentWithGemini(prompt, systemPrompt);
        document.getElementById('caseOutput').value = resultText;
        showStatusMessage('–ö–µ–π—Å—ã —É—Å–ø–µ—à–Ω–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω—ã!');
      } catch (error) {
        document.getElementById('caseOutput').value = '–û—à–∏–±–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.';
      } finally {
        toggleLoader('generateCasesBtn', false);
      }
    }

    async function generateFunnels() {
      if (selectedNichesArr.length === 0 || selectedSegmentsArr.length === 0 || selectedPainsArr.length === 0) {
        showStatusMessage('–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ –Ω–∏—à—É, —Å–µ–≥–º–µ–Ω—Ç –∏ –±–æ–ª—å!');
        return;
      }
      toggleLoader('generateFunnelsBtn', true);
      const prompt = `–°–≥–µ–Ω–µ—Ä–∏—Ä—É–π 3-5 –∏–¥–µ–π –≤–æ—Ä–æ–Ω–æ–∫ –ø—Ä–æ–¥–∞–∂ –ø–æ –º–æ–¥–µ–ª–∏ AIDA (Attention, Interest, Desire, Action) –¥–ª—è –Ω–∏—à: ${selectedNichesArr.join(', ')}. –í–æ—Ä–æ–Ω–∫–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã –Ω–∞ —Å–µ–≥–º–µ–Ω—Ç—ã: ${selectedSegmentsArr.join(', ')} –∏ —Ä–µ—à–∞—Ç—å –∏—Ö –±–æ–ª–∏: ${selectedPainsArr.join(', ')}. –û–ø–∏—à–∏ –∫–∞–∂–¥—ã–π —ç—Ç–∞–ø –≤–æ—Ä–æ–Ω–∫–∏ –ø–æ–¥—Ä–æ–±–Ω–æ, —É—á–∏—Ç—ã–≤–∞—è —Å–ø–µ—Ü–∏—Ñ–∏–∫—É –∞—É–¥–∏—Ç–æ—Ä–∏–∏.`;
      const systemPrompt = '–¢—ã - —Å—Ç—Ä–∞—Ç–µ–≥ –ø–æ –ø—Ä–æ–¥–∞–∂–∞–º, –∫–æ—Ç–æ—Ä—ã–π —Ä–∞–∑—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ –≤–æ—Ä–æ–Ω–∫–∏ –¥–ª—è –±–∏–∑–Ω–µ—Å–∞.';
      try {
        const resultText = await generateContentWithGemini(prompt, systemPrompt);
        document.getElementById('funnelOutput').value = resultText;
        showStatusMessage('–í–æ—Ä–æ–Ω–∫–∞ —É—Å–ø–µ—à–Ω–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–∞!');
      } catch (error) {
        document.getElementById('funnelOutput').value = '–û—à–∏–±–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.';
      } finally {
        toggleLoader('generateFunnelsBtn', false);
      }
    }

    async function generateSocialMediaContent() {
      if (selectedNichesArr.length === 0 || selectedSegmentsArr.length === 0 || selectedPainsArr.length === 0 || !selectedContentType) {
        showStatusMessage('–í—ã–±–µ—Ä–∏—Ç–µ –Ω–∏—à—É, —Å–µ–≥–º–µ–Ω—Ç, –±–æ–ª—å –∏ —Ç–∏–ø –∫–æ–Ω—Ç–µ–Ω—Ç–∞!');
        return;
      }
      toggleLoader('generateSocialMediaBtn', true);
      const prompt = `–°–≥–µ–Ω–µ—Ä–∏—Ä—É–π 3-5 –∏–¥–µ–π –¥–ª—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞ —Ñ–æ—Ä–º–∞—Ç–∞ "${selectedContentType}". –ö–æ–Ω—Ç–µ–Ω—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –Ω–∏—à–∏: ${selectedNichesArr.join(', ')}. –£—á–∏—Ç—ã–≤–∞–π, —á—Ç–æ –∫–æ–Ω—Ç–µ–Ω—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–∞—Ü–µ–ª–µ–Ω –Ω–∞ —Å–µ–≥–º–µ–Ω—Ç—ã: ${selectedSegmentsArr.join(', ')} –∏ —Ä–µ—à–∞—Ç—å –∏—Ö –±–æ–ª–∏: ${selectedPainsArr.join(', ')}. –û–ø–∏—à–∏ –∫–∞–∂–¥—É—é –∏–¥–µ—é —Å —É—á–µ—Ç–æ–º —Å–ø–µ—Ü–∏—Ñ–∏–∫–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ (–≤–∏–∑—É–∞–ª, —Ç–µ–∫—Å—Ç, —Ñ–æ—Ä–º–∞—Ç).`;
      const systemPrompt = '–¢—ã - SMM-–º–µ–Ω–µ–¥–∂–µ—Ä, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏–¥—É–º—ã–≤–∞–µ—Ç –∫—Ä–µ–∞—Ç–∏–≤–Ω—ã–π –∏ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç –¥–ª—è —Å–æ—Ü—Å–µ—Ç–µ–π.';
      try {
        const resultText = await generateContentWithGemini(prompt, systemPrompt);
        document.getElementById('socialMediaOutput').value = resultText;
        showStatusMessage('–ò–¥–µ–∏ –¥–ª—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞ —É—Å–ø–µ—à–Ω–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω—ã!');
      } catch (error) {
        document.getElementById('socialMediaOutput').value = '–û—à–∏–±–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.';
      } finally {
        toggleLoader('generateSocialMediaBtn', false);
      }
    }

    document.addEventListener('DOMContentLoaded', populateNiches);
  </script>

</body>
</html>
